/*! jQuery Timepicker Addon - v1.6.3 - 2016-04-20
 * http://trentrichardson.com/examples/timepicker
 * Modified version of jQuery Timepicker
 * Copyright (c) 2016 Trent Richardson; Licensed MIT */
(function(factory){'use strict';if(typeof window.define==='function'&&window.define.amd){window.define(['jquery','jquery-ui'],factory)}else{factory(window.jQuery)}}(function($){'use strict';var extendRemove=function(target,props){var name;$.extend(target,props);for(name in props){if(props[name]===null||props[name]===undefined){target[name]=props[name]}}
return target};var isEmptyObject=function(obj){var prop;for(prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){return!1}}
return!0};var detectSupport=function(timeFormat){var tf=timeFormat.replace(/'.*?'/g,'').toLowerCase(),isIn=function(f,t){return f.indexOf(t)!==-1?!0:!1};return{hour:isIn(tf,'h'),minute:isIn(tf,'m'),second:isIn(tf,'s'),millisec:isIn(tf,'l'),microsec:isIn(tf,'c'),timezone:isIn(tf,'z'),ampm:isIn(tf,'t')&&isIn(timeFormat,'h'),iso8601:isIn(timeFormat,'Z')}};var convert24to12=function(hour){hour%=12;if(hour===0){hour=12}
return String(hour)};var computeEffectiveSetting=function(settings,property){return settings&&settings[property]?settings[property]:$.tm_timepicker._defaults[property]};var splitDateTime=function(dateTimeString,timeSettings){var separator=computeEffectiveSetting(timeSettings,'separator'),format=computeEffectiveSetting(timeSettings,'timeFormat'),timeParts=format.split(separator),timePartsLen=timeParts.length,allParts=dateTimeString.split(separator),allPartsLen=allParts.length;if(allPartsLen>1){return{dateString:allParts.splice(0,allPartsLen-timePartsLen).join(separator),timeString:allParts.splice(0,timePartsLen).join(separator)}}
return{dateString:dateTimeString,timeString:''}};var parseDateTimeInternal=function(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings){var date,parts,parsedTime;parts=splitDateTime(dateTimeString,timeSettings);date=$.tm_datepicker._base_parseDate(dateFormat,parts.dateString,dateSettings);if(parts.timeString===''){return{date:date}}
parsedTime=$.tm_datepicker.parseTime(timeFormat,parts.timeString,timeSettings);if(!parsedTime){throw 'Wrong time format'}
return{date:date,timeObj:parsedTime}};var selectLocalTimezone=function(tp_inst,date){var now;if(tp_inst&&tp_inst.timezone_select){now=date||new Date();tp_inst.timezone_select.val(-now.getTimezoneOffset())}};var Timepicker=function(){this.regional=[];this.regional['']={currentText:'Now',closeText:'Done',amNames:['AM','A'],pmNames:['PM','P'],timeFormat:'HH:mm',timeSuffix:'',timeOnlyTitle:'Choose Time',timeText:'Time',hourText:'Hour',minuteText:'Minute',secondText:'Second',millisecText:'Millisecond',microsecText:'Microsecond',timezoneText:'Time Zone',isRTL:!1};this._defaults={showButtonPanel:!0,timeOnly:!1,timeOnlyShowDate:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,maxTime:null,minTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:' ',altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,altRedirectFocus:!0,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:'slider',oneLine:!1,defaultValue:null,parse:'strict',afterInject:null};$.extend(this._defaults,this.regional[''])};$.ui.tm_timepicker=$.ui.tm_timepicker||{};if($.ui.tm_timepicker.version){return}
$.extend($.ui,{tm_timepicker:{version:'1.6.3'}});$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,maxTime:null,minTime:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:'',formattedDate:'',formattedTime:'',formattedDateTime:'',timezoneList:null,units:['hour','minute','second','millisec','microsec'],support:{},control:null,setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_newInst:function($input,opts){var tp_inst=new Timepicker(),inlineSettings={},fns={},overrides,i;var attrName;var attrValue;var timezoneList;var tzl;var tzi=0;var tzv=null;for(attrName in this._defaults){if(Object.prototype.hasOwnProperty.call(this._defaults,attrName)){attrValue=$input.attr('data-'+attrName);if(attrValue){inlineSettings[attrName]=attrValue}}}
overrides={beforeShow:function(input,dp_inst){if(typeof tp_inst._defaults.evnts.beforeShow==='function'){return tp_inst._defaults.evnts.beforeShow.call($input[0],input,dp_inst,tp_inst)}},onChangeMonthYear:function(year,month,dp_inst){if(typeof tp_inst._defaults.evnts.onChangeMonthYear==='function'){tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],year,month,dp_inst,tp_inst)}},onClose:function(dateText,dp_inst){if(tp_inst.timeDefined===!0&&$input.val()!==''){tp_inst._updateDateTime(dp_inst)}
if(typeof tp_inst._defaults.evnts.onClose==='function'){tp_inst._defaults.evnts.onClose.call($input[0],dateText,dp_inst,tp_inst)}}};for(i in overrides){if(Object.prototype.hasOwnProperty.call(overrides,i)){fns[i]=opts[i]||this._defaults[i]||null}}
tp_inst._defaults=$.extend({},this._defaults,inlineSettings,opts,overrides,{evnts:fns,tm_timepicker:tp_inst});tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(val){return val.toUpperCase()});tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(val){return val.toUpperCase()});tp_inst.support=detectSupport(tp_inst._defaults.timeFormat+(tp_inst._defaults.pickerTimeFormat?tp_inst._defaults.pickerTimeFormat:'')+(tp_inst._defaults.altTimeFormat?tp_inst._defaults.altTimeFormat:''));if(typeof tp_inst._defaults.controlType==='string'){if(tp_inst._defaults.controlType==='slider'&&typeof $.ui.slider==='undefined'){tp_inst._defaults.controlType='select'}
tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]}else{tp_inst.control=tp_inst._defaults.controlType}
timezoneList=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];if(tp_inst._defaults.timezoneList!==null){timezoneList=tp_inst._defaults.timezoneList}
tzl=timezoneList.length;if(tzl>0&&typeof timezoneList[0]!=='object'){for(;tzi<tzl;tzi+=1){tzv=timezoneList[tzi];timezoneList[tzi]={value:tzv,label:$.tm_timepicker.timezoneOffsetString(tzv,tp_inst.support.iso8601)}}}
tp_inst._defaults.timezoneList=timezoneList;tp_inst.timezone=tp_inst._defaults.timezone!==null?$.tm_timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone):new Date().getTimezoneOffset()*-1;tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute;tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second;tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec;tp_inst.microsec=tp_inst._defaults.microsec<tp_inst._defaults.microsecMin?tp_inst._defaults.microsecMin:tp_inst._defaults.microsec>tp_inst._defaults.microsecMax?tp_inst._defaults.microsecMax:tp_inst._defaults.microsec;tp_inst.ampm='';tp_inst.$input=$input;if(tp_inst._defaults.altField){tp_inst.$altInput=$(tp_inst._defaults.altField);if(tp_inst._defaults.altRedirectFocus===!0){tp_inst.$altInput.css({cursor:'pointer'}).on('focus',function(){$input.trigger('focus')})}}
if(tp_inst._defaults.minDate===0||tp_inst._defaults.minDateTime===0){tp_inst._defaults.minDate=new Date()}
if(tp_inst._defaults.maxDate===0||tp_inst._defaults.maxDateTime===0){tp_inst._defaults.maxDate=new Date()}
if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date){tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())}
if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date){tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())}
if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date){tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())}
if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date){tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())}
tp_inst.$input.on('focus',function(){tp_inst._onFocus()});tp_inst.$input.next('.ui-tm-timepicker-trigger').on('click',function(){tp_inst._onFocus();return!1});return tp_inst},_addTimePicker:function(dp_inst){var currDT=$.epoAPI.util.trim(this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+' '+this.$altInput.val():this.$input.val());this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,!1);this._injectTimePicker();this._afterInject()},_parseTime:function(timeString,withDate){var dp_dateFormat;var parseRes;var timeObj;if(!this.inst){this.inst=$.tm_datepicker._getInst(this.$input[0])}
if(withDate||!this._defaults.timeOnly){dp_dateFormat=$.tm_datepicker._get(this.inst,'dateFormat');try{parseRes=parseDateTimeInternal(dp_dateFormat,this._defaults.timeFormat,timeString,$.tm_datepicker._getFormatConfig(this.inst),this._defaults);if(!parseRes.timeObj){return!1}
$.extend(this,parseRes.timeObj)}catch(err){$.tm_timepicker.log('Error parsing the date/time string: '+err+'\ndate/time string = '+timeString+'\ntimeFormat = '+this._defaults.timeFormat+'\ndateFormat = '+dp_dateFormat);return!1}
return!0}
timeObj=$.tm_datepicker.parseTime(this._defaults.timeFormat,timeString,this._defaults);if(!timeObj){return!1}
$.extend(this,timeObj);return!0},_afterInject:function(){var o=this.inst.settings;if(typeof o.afterInject==='function'){o.afterInject.call(this)}},_ui_tpicker_onclick:function(event){var $t=$(event.target),h=$t.html(),n=parseInt(h.replace(/[^0-9]/g),10),ap=h.replace(/[^apm]/gi),f=$t.data('for');if(f==='hour'){if(ap.indexOf('p')!==-1&&n<12){n+=12}else if(ap.indexOf('a')!==-1&&n===12){n=0}}
event.data.tp_inst.control.value(event.data.tp_inst,event.data.tp_inst[f+'_slider'],event.data.litem,n);event.data.tp_inst._onTimeChange();event.data.tp_inst._onSelectHandler()},_injectTimePicker:function(){var $dp=this.inst.dpDiv,o=this.inst.settings,tp_inst=this,litem='',uitem='',show=null,max={},gridSize={},size=null,i=0,l=0;var noDisplay;var html;var h;var tmph;var m;var showTz;var $tp;var local_timezone;var $buttonPanel;var timeDefined;var sliderAccessArgs;var rtl;if($dp.find('div.ui-tm-timepicker-div').length===0&&o.showTimepicker){noDisplay=' ui_tpicker_unit_hide';html='<div class="ui-tm-timepicker-div'+(o.isRTL?' ui-tm-timepicker-rtl':'')+(o.oneLine&&o.controlType==='select'?' ui-tm-timepicker-oneLine':'')+'"><dl>'+'<dt class="ui_tpicker_time_label'+(o.showTime?'':noDisplay)+'">'+o.timeText+'</dt>'+'<dd class="ui_tpicker_time '+(o.showTime?'':noDisplay)+'"><input class="ui_tpicker_time_input" '+(o.timeInput?'':'disabled')+'></dd>';for(i=0,l=this.units.length;i<l;i+=1){litem=this.units[i];uitem=litem.substring(0,1).toUpperCase()+litem.substring(1);show=o['show'+uitem]!==null?o['show'+uitem]:this.support[litem];max[litem]=parseInt(o[litem+'Max']-((o[litem+'Max']-o[litem+'Min'])%o['step'+uitem]),10);gridSize[litem]=0;html+='<dt class="ui_tpicker_'+litem+'_label'+(show?'':noDisplay)+'">'+o[litem+'Text']+'</dt>'+'<dd class="ui_tpicker_'+litem+(show?'':noDisplay)+'"><div class="ui_tpicker_'+litem+'_slider'+(show?'':noDisplay)+'"></div>';if(show&&o[litem+'Grid']>0){html+='<div><table class="ui-tpicker-grid-label"><tr>';if(litem==='hour'){for(h=o[litem+'Min'];h<=max[litem];h+=parseInt(o[litem+'Grid'],10)){gridSize[litem]+=1;tmph=$.tm_datepicker.formatTime(this.support.ampm?'hht':'HH',{hour:h},o);html+='<td data-for="'+litem+'">'+tmph+'</td>'}}else{for(m=o[litem+'Min'];m<=max[litem];m+=parseInt(o[litem+'Grid'],10)){gridSize[litem]+=1;html+='<td data-for="'+litem+'">'+(m<10?'0':'')+m+'</td>'}}
html+='</tr></table></div>'}
html+='</dd>'}
showTz=o.showTimezone!==null?o.showTimezone:this.support.timezone;html+='<dt class="ui_tpicker_timezone_label'+(showTz?'':noDisplay)+'">'+o.timezoneText+'</dt>';html+='<dd class="ui_tpicker_timezone'+(showTz?'':noDisplay)+'"></dd>';html+='</dl></div>';$tp=$(html);if(o.timeOnly===!0){$tp.prepend('<div class="tm-ui-widget-header">'+'<div class="tm-ui-tp-title">'+o.timeOnlyTitle+'</div>'+'</div>');$dp.find('.tm-ui-dp-inner-container').hide()}
for(i=0,l=tp_inst.units.length;i<l;i+=1){litem=tp_inst.units[i];uitem=litem.substring(0,1).toUpperCase()+litem.substring(1);show=o['show'+uitem]!==null?o['show'+uitem]:this.support[litem];tp_inst[litem+'_slider']=tp_inst.control.create(tp_inst,$tp.find('.ui_tpicker_'+litem+'_slider'),litem,tp_inst[litem],o[litem+'Min'],max[litem],o['step'+uitem]);if(show&&o[litem+'Grid']>0){size=(100*gridSize[litem]*o[litem+'Grid'])/(max[litem]-o[litem+'Min']);$tp.find('.ui_tpicker_'+litem+' table').css({width:size+'%',marginLeft:o.isRTL?'0':(size/(-2*gridSize[litem]))+'%',marginRight:o.isRTL?(size/(-2*gridSize[litem]))+'%':'0',borderCollapse:'collapse'}).find('td').on('click',{that:this,tp_inst:tp_inst,litem:litem},this._ui_tpicker_onclick).css({cursor:'pointer',width:(100/gridSize[litem])+'%',textAlign:'center',overflow:'hidden'})}}
this.timezone_select=$tp.find('.ui_tpicker_timezone').append('<select></select>').find('select');$.fn.append.apply(this.timezone_select,$.map(o.timezoneList,function(val){return $('<option />').val(typeof val==='object'?val.value:val).text(typeof val==='object'?val.label:val)}));if(typeof this.timezone!=='undefined'&&this.timezone!==null&&this.timezone!==''){local_timezone=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset()*-1;if(local_timezone===this.timezone){selectLocalTimezone(tp_inst)}else{this.timezone_select.val(this.timezone)}}else if(typeof this.hour!=='undefined'&&this.hour!==null&&this.hour!==''){this.timezone_select.val(o.timezone)}else{selectLocalTimezone(tp_inst)}
this.timezone_select.on('change',function(){tp_inst._onTimeChange();tp_inst._onSelectHandler();tp_inst._afterInject()});$buttonPanel=$dp.find('.tm-ui-dp-buttonpane');if($buttonPanel.length){$buttonPanel.before($tp)}else{$dp.append($tp)}
this.$timeObj=$tp.find('.ui_tpicker_time_input');this.$timeObj.on('change',function(){var timeFormat=tp_inst.inst.settings.timeFormat;var parsedTime=$.tm_datepicker.parseTime(timeFormat,this.value);var update=new Date();if(parsedTime){update.setHours(parsedTime.hour);update.setMinutes(parsedTime.minute);update.setSeconds(parsedTime.second);$.datepicker._setTime(tp_inst.inst,update)}else{this.value=tp_inst.formattedTime;this.trigger('blur')}});if(this.inst!==null){timeDefined=this.timeDefined;this._onTimeChange();this.timeDefined=timeDefined}
if(this._defaults.addSliderAccess){sliderAccessArgs=this._defaults.sliderAccessArgs;rtl=this._defaults.isRTL;sliderAccessArgs.isRTL=rtl;setTimeout(function(){var sliderAccessWidth;if($tp.find('.ui-slider-access').length===0){$tp.find('.ui-slider:visible').sliderAccess(sliderAccessArgs);sliderAccessWidth=$tp.find('.ui-slider-access:eq(0)').outerWidth(!0);if(sliderAccessWidth){$tp.find('table:visible').each(function(){var $g=$(this),oldWidth=$g.outerWidth(),oldMarginLeft=$g.css(rtl?'marginRight':'marginLeft').toString().replace('%',''),newWidth=oldWidth-sliderAccessWidth,newMarginLeft=((oldMarginLeft*newWidth)/oldWidth)+'%',css={width:newWidth,marginRight:0,marginLeft:0};css[rtl?'marginRight':'marginLeft']=newMarginLeft;$g.css(css)})}}},10)}
tp_inst._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(dp_inst,adjustSliders){var o=this._defaults,dp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);var minDateTime;var minDateTimeDate;var maxDateTime;var maxDateTimeDate;var tempMinTime;var tempMaxTime;var hourMax;var minMax;var secMax;var millisecMax;var microsecMax;if(!this._defaults.showTimepicker){return}
if($.tm_datepicker._get(dp_inst,'minDateTime')!==null&&$.tm_datepicker._get(dp_inst,'minDateTime')!==undefined&&dp_date){minDateTime=$.tm_datepicker._get(dp_inst,'minDateTime');minDateTimeDate=new Date(minDateTime.getFullYear(),minDateTime.getMonth(),minDateTime.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null||this.microsecMinOriginal===null){this.hourMinOriginal=o.hourMin;this.minuteMinOriginal=o.minuteMin;this.secondMinOriginal=o.secondMin;this.millisecMinOriginal=o.millisecMin;this.microsecMinOriginal=o.microsecMin}
if(dp_inst.settings.timeOnly||minDateTimeDate.getTime()===dp_date.getTime()){this._defaults.hourMin=minDateTime.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;this._defaults.minuteMin=minDateTime.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=minDateTime.getSeconds();if(this.second<=this._defaults.secondMin){this.second=this._defaults.secondMin;this._defaults.millisecMin=minDateTime.getMilliseconds();if(this.millisec<=this._defaults.millisecMin){this.millisec=this._defaults.millisecMin;this._defaults.microsecMin=minDateTime.getMicroseconds()}else{if(this.microsec<this._defaults.microsecMin){this.microsec=this._defaults.microsecMin}
this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}
if($.tm_datepicker._get(dp_inst,'maxDateTime')!==null&&$.tm_datepicker._get(dp_inst,'maxDateTime')!==undefined&&dp_date){maxDateTime=$.tm_datepicker._get(dp_inst,'maxDateTime');maxDateTimeDate=new Date(maxDateTime.getFullYear(),maxDateTime.getMonth(),maxDateTime.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null||this.millisecMaxOriginal===null){this.hourMaxOriginal=o.hourMax;this.minuteMaxOriginal=o.minuteMax;this.secondMaxOriginal=o.secondMax;this.millisecMaxOriginal=o.millisecMax;this.microsecMaxOriginal=o.microsecMax}
if(dp_inst.settings.timeOnly||maxDateTimeDate.getTime()===dp_date.getTime()){this._defaults.hourMax=maxDateTime.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=maxDateTime.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=maxDateTime.getSeconds();if(this.second>=this._defaults.secondMax){this.second=this._defaults.secondMax;this._defaults.millisecMax=maxDateTime.getMilliseconds();if(this.millisec>=this._defaults.millisecMax){this.millisec=this._defaults.millisecMax;this._defaults.microsecMax=maxDateTime.getMicroseconds()}else{if(this.microsec>this._defaults.microsecMax){this.microsec=this._defaults.microsecMax}
this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}
if(dp_inst.settings.minTime!==null){tempMinTime=new Date('01/01/1970 '+dp_inst.settings.minTime);if(parseFloat(dp_inst.settings.minTime).toString()===dp_inst.settings.minTime){tempMinTime=new Date(Date.now()+parseFloat(dp_inst.settings.minTime))}
if(this.hour<tempMinTime.getHours()){this._defaults.hourMin=tempMinTime.getHours();this.hour=this._defaults.hourMin;this._defaults.minuteMin=tempMinTime.getMinutes();this.minute=this._defaults.minuteMin}else if(this.hour===tempMinTime.getHours()&&this.minute<tempMinTime.getMinutes()){this._defaults.minuteMin=tempMinTime.getMinutes();this.minute=this._defaults.minuteMin}else if(this._defaults.hourMin<tempMinTime.getHours()){this._defaults.hourMin=tempMinTime.getHours();this._defaults.minuteMin=tempMinTime.getMinutes()}else if((this._defaults.hourMin===tempMinTime.getHours())===this.hour&&this._defaults.minuteMin<tempMinTime.getMinutes()){this._defaults.minuteMin=tempMinTime.getMinutes()}else{this._defaults.minuteMin=0}}
if(dp_inst.settings.maxTime!==null){tempMaxTime=new Date('01/01/1970 '+dp_inst.settings.maxTime);if(this.hour>tempMaxTime.getHours()){this._defaults.hourMax=tempMaxTime.getHours();this.hour=this._defaults.hourMax;this._defaults.minuteMax=tempMaxTime.getMinutes();this.minute=this._defaults.minuteMax}else if(this.hour===tempMaxTime.getHours()&&this.minute>tempMaxTime.getMinutes()){this._defaults.minuteMax=tempMaxTime.getMinutes();this.minute=this._defaults.minuteMax}else if(this._defaults.hourMax>tempMaxTime.getHours()){this._defaults.hourMax=tempMaxTime.getHours();this._defaults.minuteMax=tempMaxTime.getMinutes()}else if((this._defaults.hourMax===tempMaxTime.getHours())===this.hour&&this._defaults.minuteMax>tempMaxTime.getMinutes()){this._defaults.minuteMax=tempMaxTime.getMinutes()}else{this._defaults.minuteMax=59}}
if(adjustSliders!==undefined&&adjustSliders===!0){hourMax=parseInt(this._defaults.hourMax-((this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour),10);minMax=parseInt(this._defaults.minuteMax-((this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute),10);secMax=parseInt(this._defaults.secondMax-((this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond),10);millisecMax=parseInt(this._defaults.millisecMax-((this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec),10);microsecMax=parseInt(this._defaults.microsecMax-((this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec),10);if(this.hour_slider){this.control.options(this,this.hour_slider,'hour',{min:this._defaults.hourMin,max:hourMax,step:this._defaults.stepHour});this.control.value(this,this.hour_slider,'hour',this.hour-(this.hour%this._defaults.stepHour))}
if(this.minute_slider){this.control.options(this,this.minute_slider,'minute',{min:this._defaults.minuteMin,max:minMax,step:this._defaults.stepMinute});this.control.value(this,this.minute_slider,'minute',this.minute-(this.minute%this._defaults.stepMinute))}
if(this.second_slider){this.control.options(this,this.second_slider,'second',{min:this._defaults.secondMin,max:secMax,step:this._defaults.stepSecond});this.control.value(this,this.second_slider,'second',this.second-(this.second%this._defaults.stepSecond))}
if(this.millisec_slider){this.control.options(this,this.millisec_slider,'millisec',{min:this._defaults.millisecMin,max:millisecMax,step:this._defaults.stepMillisec});this.control.value(this,this.millisec_slider,'millisec',this.millisec-(this.millisec%this._defaults.stepMillisec))}
if(this.microsec_slider){this.control.options(this,this.microsec_slider,'microsec',{min:this._defaults.microsecMin,max:microsecMax,step:this._defaults.stepMicrosec});this.control.value(this,this.microsec_slider,'microsec',this.microsec-(this.microsec%this._defaults.stepMicrosec))}}},_onTimeChange:function(){var hour=this.hour_slider?this.control.value(this,this.hour_slider,'hour'):!1,minute=this.minute_slider?this.control.value(this,this.minute_slider,'minute'):!1,second=this.second_slider?this.control.value(this,this.second_slider,'second'):!1,millisec=this.millisec_slider?this.control.value(this,this.millisec_slider,'millisec'):!1,microsec=this.microsec_slider?this.control.value(this,this.microsec_slider,'microsec'):!1,timezone=this.timezone_select?this.timezone_select.val():!1,o=this._defaults,pickerTimeFormat=o.pickerTimeFormat||o.timeFormat,pickerTimeSuffix=o.pickerTimeSuffix||o.timeSuffix;var ampm;var hasChanged;var sPos;var ePos;if(!this._defaults.showTimepicker){return}
if(typeof hour==='object'){hour=!1}
if(typeof minute==='object'){minute=!1}
if(typeof second==='object'){second=!1}
if(typeof millisec==='object'){millisec=!1}
if(typeof microsec==='object'){microsec=!1}
if(typeof timezone==='object'){timezone=!1}
if(hour!==!1){hour=parseInt(hour,10)}
if(minute!==!1){minute=parseInt(minute,10)}
if(second!==!1){second=parseInt(second,10)}
if(millisec!==!1){millisec=parseInt(millisec,10)}
if(microsec!==!1){microsec=parseInt(microsec,10)}
if(timezone!==!1){timezone=timezone.toString()}
ampm=o[hour<12?'amNames':'pmNames'][0];hasChanged=hour!==parseInt(this.hour,10)||minute!==parseInt(this.minute,10)||second!==parseInt(this.second,10)||millisec!==parseInt(this.millisec,10)||microsec!==parseInt(this.microsec,10)||(this.ampm.length>0&&(hour<12)!==($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1))||(this.timezone!==null&&timezone!==this.timezone.toString());if(hasChanged){if(hour!==!1){this.hour=hour}
if(minute!==!1){this.minute=minute}
if(second!==!1){this.second=second}
if(millisec!==!1){this.millisec=millisec}
if(microsec!==!1){this.microsec=microsec}
if(timezone!==!1){this.timezone=timezone}
if(!this.inst){this.inst=$.tm_datepicker._getInst(this.$input[0])}
this._limitMinMaxDateTime(this.inst,!0)}
if(this.support.ampm){this.ampm=ampm}
this.formattedTime=$.tm_datepicker.formatTime(o.timeFormat,this,o);if(this.$timeObj){if(pickerTimeFormat===o.timeFormat){this.$timeObj.val(this.formattedTime+pickerTimeSuffix)}else{this.$timeObj.val($.tm_datepicker.formatTime(pickerTimeFormat,this,o)+pickerTimeSuffix)}
if(this.$timeObj[0].setSelectionRange){sPos=this.$timeObj[0].selectionStart;ePos=this.$timeObj[0].selectionEnd;this.$timeObj[0].setSelectionRange(sPos,ePos)}}
this.timeDefined=!0;if(hasChanged){this._updateDateTime()}},_onSelectHandler:function(){var onSelect=this._defaults.onSelect||this.inst.settings.onSelect;var inputEl=this.$input?this.$input[0]:null;if(onSelect&&inputEl){onSelect.apply(inputEl,[this.formattedDateTime,this])}},_updateDateTime:function(dp_inst){var dtTmp;var dt;var dateFmt;var formatCfg;var timeAvailable;var formattedDateTime;var altFormattedDateTime='';var altSeparator;var altTimeSuffix;dp_inst=this.inst||dp_inst;dtTmp=dp_inst.currentYear>0?new Date(dp_inst.currentYear,dp_inst.currentMonth,dp_inst.currentDay):new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);dt=$.tm_datepicker._daylightSavingAdjust(dtTmp);dateFmt=$.tm_datepicker._get(dp_inst,'dateFormat');formatCfg=$.tm_datepicker._getFormatConfig(dp_inst);timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.tm_datepicker.formatDate(dateFmt,dt===null?new Date():dt,formatCfg);formattedDateTime=this.formattedDate;if(dp_inst.lastVal===''){dp_inst.currentYear=dp_inst.selectedYear;dp_inst.currentMonth=dp_inst.selectedMonth;dp_inst.currentDay=dp_inst.selectedDay}
if(this._defaults.timeOnly===!0&&this._defaults.timeOnlyShowDate===!1){formattedDateTime=this.formattedTime}else if((this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||timeAvailable))||(this._defaults.timeOnly===!0&&this._defaults.timeOnlyShowDate===!0)){formattedDateTime+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix}
this.formattedDateTime=formattedDateTime;if(!this._defaults.showTimepicker){this.$input.val(this.formattedDate)}else if(this.$altInput&&this._defaults.timeOnly===!1&&this._defaults.altFieldTimeOnly===!0){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else if(this.$altInput){this.$input.val(formattedDateTime);altFormattedDateTime='';altSeparator=this._defaults.altSeparator!==null?this._defaults.altSeparator:this._defaults.separator;altTimeSuffix=this._defaults.altTimeSuffix!==null?this._defaults.altTimeSuffix:this._defaults.timeSuffix;if(!this._defaults.timeOnly){if(this._defaults.altFormat){altFormattedDateTime=$.tm_datepicker.formatDate(this._defaults.altFormat,dt===null?new Date():dt,formatCfg)}else{altFormattedDateTime=this.formattedDate}
if(altFormattedDateTime){altFormattedDateTime+=altSeparator}}
if(this._defaults.altTimeFormat!==null){altFormattedDateTime+=$.tm_datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+altTimeSuffix}else{altFormattedDateTime+=this.formattedTime+altTimeSuffix}
this.$altInput.val(altFormattedDateTime)}else{this.$input.val(formattedDateTime)}
this.$input.trigger('change')},_onFocus:function(){var inst;var tp_inst;if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);inst=$.tm_datepicker._getInst(this.$input.get(0));tp_inst=$.tm_datepicker._get(inst,'tm_timepicker');if(tp_inst){if(tp_inst._defaults.timeOnly&&inst.input.val()!==inst.lastVal){try{$.tm_datepicker._updateDatepicker(inst)}catch(err){$.tm_timepicker.log(err)}}}}},_controls:{slider:{create:function(tp_inst,obj,unit,val,min,max,step){var rtl=tp_inst._defaults.isRTL;return obj.prop('slide',null).slider({orientation:'horizontal',value:rtl?val*-1:val,min:rtl?max*-1:min,max:rtl?min*-1:max,step:step,slide:function(event,ui){tp_inst.control.value(tp_inst,$(this),unit,rtl?ui.value*-1:ui.value);tp_inst._onTimeChange()},stop:function(){tp_inst._onSelectHandler()}})},options:function(tp_inst,obj,unit,opts,val){var min;var max;if(tp_inst._defaults.isRTL){if(typeof opts==='string'){if(opts==='min'||opts==='max'){if(val!==undefined){return obj.slider(opts,val*-1)}
return Math.abs(obj.slider(opts))}
return obj.slider(opts)}
min=opts.min;max=opts.max;opts.max=null;opts.min=null;if(min!==undefined){opts.max=min*-1}
if(max!==undefined){opts.min=max*-1}
return obj.slider(opts)}
if(typeof opts==='string'&&val!==undefined){return obj.slider(opts,val)}
return obj.slider(opts)},value:function(tp_inst,obj,unit,val){if(tp_inst._defaults.isRTL){if(val!==undefined){return obj.slider('value',val*-1)}
return Math.abs(obj.slider('value'))}
if(val!==undefined){return obj.slider('value',val)}
return obj.slider('value')}},select:{create:function(tp_inst,obj,unit,val,min,max,step){var sel='<select class="ui-tm-timepicker-select ui-state-default ui-corner-all" data-unit="'+unit+'" data-min="'+min+'" data-max="'+max+'" data-step="'+step+'">',format=tp_inst._defaults.pickerTimeFormat||tp_inst._defaults.timeFormat;var i;for(i=min;i<=max;i+=step){sel+='<option value="'+i+'"'+(i===val?' selected':'')+'>';if(unit==='hour'){sel+=$.tm_datepicker.formatTime($.epoAPI.util.trim(format.replace(/[^ht ]/gi,'')),{hour:i},tp_inst._defaults)}else if(unit==='millisec'||unit==='microsec'||i>=10){sel+=i}else{sel+='0'+i.toString()}
sel+='</option>'}
sel+='</select>';obj.children('select').remove();$(sel).appendTo(obj).on('change',function(){tp_inst._onTimeChange();tp_inst._onSelectHandler();tp_inst._afterInject()});return obj},options:function(tp_inst,obj,unit,opts,val){var o={},$t=obj.children('select');if(typeof opts==='string'){if(val===undefined){return $t.data(opts)}
o[opts]=val}else{o=opts}
return tp_inst.control.create(tp_inst,obj,$t.data('unit'),$t.val(),o.min>=0?o.min:$t.data('min'),o.max||$t.data('max'),o.step||$t.data('step'))},value:function(tp_inst,obj,unit,val){var $t=obj.children('select');if(val!==undefined){return $t.val(val)}
return $t.val()}}}});$.fn.extend({tm_timepicker:function(o){var tmp_args=Array.prototype.slice.call(arguments);o=o||{};if(typeof o==='object'){tmp_args[0]=$.extend(o,{timeOnly:!0})}
return $(this).each(function(){$.fn.tm_datetimepicker.apply($(this),tmp_args)})},tm_datetimepicker:function(o){var tmp_args=arguments;o=o||{};if(typeof o==='string'){if(o==='getDate'||(o==='option'&&tmp_args.length===2&&typeof tmp_args[1]==='string')){return $.fn.tm_datepicker.apply($(this[0]),tmp_args)}
return this.each(function(){var $t=$(this);$t.tm_datepicker.apply($t,tmp_args)})}
return this.each(function(){var $t=$(this);$t.tm_datepicker($.tm_timepicker._newInst($t,o)._defaults)})}});$.tm_datepicker.parseDateTime=function(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings){var parseRes=parseDateTimeInternal(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings);var t;if(parseRes.timeObj){t=parseRes.timeObj;parseRes.date.setHours(t.hour,t.minute,t.second,t.millisec);parseRes.date.setMicroseconds(t.microsec)}
return parseRes.date};$.tm_datepicker.parseTime=function(timeFormat,timeString,options){var o=extendRemove(extendRemove({},$.tm_timepicker._defaults),options||{});var strictParse=function(f,s,oo){var getPatternAmpm=function(amNames,pmNames){var markers=[];if(amNames){$.merge(markers,amNames)}
if(pmNames){$.merge(markers,pmNames)}
markers=$.map(markers,function(val){return val.replace(/[.*+?|()[\]{}\\]/g,'\\$&')});return'('+markers.join('|')+')?'};var getFormatPositions=function(formatoftime){var finds=formatoftime.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),orders={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};var i;if(finds){for(i=0;i<finds.length;i+=1){if(orders[finds[i].toString().charAt(0)]===-1){orders[finds[i].toString().charAt(0)]=i+1}}}
return orders};var regstr='^'+f.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(match){var ml=match.length;switch(match.charAt(0).toLowerCase()){case 'h':return ml===1?'(\\d?\\d)':'(\\d{'+ml+'})';case 'm':return ml===1?'(\\d?\\d)':'(\\d{'+ml+'})';case 's':return ml===1?'(\\d?\\d)':'(\\d{'+ml+'})';case 'l':return'(\\d?\\d?\\d)';case 'c':return'(\\d?\\d?\\d)';case 'z':return'(z|[-+]\\d\\d:?\\d\\d|\\S+)?';case 't':return getPatternAmpm(oo.amNames,oo.pmNames);default:return('('+match.replace(/'/g,'').replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(m){return'\\'+m})+')?')}}).replace(/\s/g,'\\s?')+oo.timeSuffix+'$',order=getFormatPositions(f),ampm='',treg;var resTime={hour:0,minute:0,second:0,millisec:0,microsec:0};treg=s.match(new RegExp(regstr,'i'));if(treg){if(order.t!==-1){if(treg[order.t]===undefined||treg[order.t].length===0){ampm='';resTime.ampm=''}else{ampm=$.inArray(treg[order.t].toUpperCase(),$.map(oo.amNames,function(x){return x.toUpperCase()}))!==-1?'AM':'PM';resTime.ampm=oo[ampm==='AM'?'amNames':'pmNames'][0]}}
if(order.h!==-1){if(ampm==='AM'&&treg[order.h]==='12'){resTime.hour=0}else if(ampm==='PM'&&treg[order.h]!=='12'){resTime.hour=parseInt(treg[order.h],10)+12}else{resTime.hour=Number(treg[order.h])}}
if(order.m!==-1){resTime.minute=Number(treg[order.m])}
if(order.s!==-1){resTime.second=Number(treg[order.s])}
if(order.l!==-1){resTime.millisec=Number(treg[order.l])}
if(order.c!==-1){resTime.microsec=Number(treg[order.c])}
if(order.z!==-1&&treg[order.z]!==undefined){resTime.timezone=$.tm_timepicker.timezoneOffsetNumber(treg[order.z])}
return resTime}
return!1};var looseParse=function(f,s,oo){var d;try{d=new Date('2012-01-01 '+s);if(isNaN(d.getTime())){d=new Date('2012-01-01T'+s);if(isNaN(d.getTime())){d=new Date('01/01/2012 '+s);if(isNaN(d.getTime())){throw 'Unable to parse time with native Date: '+s}}}
return{hour:d.getHours(),minute:d.getMinutes(),second:d.getSeconds(),millisec:d.getMilliseconds(),microsec:d.getMicroseconds(),timezone:d.getTimezoneOffset()*-1}}catch(err){try{return strictParse(f,s,oo)}catch(err2){$.tm_timepicker.log('Unable to parse \ntimeString: '+s+'\ntimeFormat: '+f)}}
return!1};if(typeof o.parse==='function'){return o.parse(timeFormat,timeString,o)}
if(o.parse==='loose'){return looseParse(timeFormat,timeString,o)}
return strictParse(timeFormat,timeString,o)};$.tm_datepicker.formatTime=function(format,time,options){var tmptime;var ampmName;var hour;options=options||{};options=$.extend({},$.tm_timepicker._defaults,options);time=$.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},time);tmptime=format;ampmName=options.amNames[0];hour=parseInt(time.hour,10);if(hour>11){ampmName=options.pmNames[0]}
tmptime=tmptime.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(match){switch(match){case 'HH':return('0'+hour).slice(-2);case 'H':return hour;case 'hh':return('0'+convert24to12(hour)).slice(-2);case 'h':return convert24to12(hour);case 'mm':return('0'+time.minute).slice(-2);case 'm':return time.minute;case 'ss':return('0'+time.second).slice(-2);case 's':return time.second;case 'l':return('00'+time.millisec).slice(-3);case 'c':return('00'+time.microsec).slice(-3);case 'z':return $.tm_timepicker.timezoneOffsetString(time.timezone===null?options.timezone:time.timezone,!1);case 'Z':return $.tm_timepicker.timezoneOffsetString(time.timezone===null?options.timezone:time.timezone,!0);case 'T':return ampmName.charAt(0).toUpperCase();case 'TT':return ampmName.toUpperCase();case 't':return ampmName.charAt(0).toLowerCase();case 'tt':return ampmName.toLowerCase();default:return match.replace(/'/g,'')}});return tmptime};$.tm_datepicker._base_selectDate=$.tm_datepicker._selectDate;$.tm_datepicker._selectDate=function(id,dateStr){var inst=this._getInst($(id)[0]),tp_inst=this._get(inst,'tm_timepicker'),was_inline;if(tp_inst&&inst.settings.showTimepicker){tp_inst._limitMinMaxDateTime(inst,!0);was_inline=inst.inline;inst.stay_open=!0;inst.inline=!0;this._base_selectDate(id,dateStr);inst.inline=was_inline;inst.stay_open=!1;this._notifyChange(inst);this._updateDatepicker(inst)}else{this._base_selectDate(id,dateStr)}};$.tm_datepicker._base_updateDatepicker=$.tm_datepicker._updateDatepicker;$.tm_datepicker._updateDatepicker=function(inst){var input=inst.input[0];var tp_inst;if($.tm_datepicker._curInst&&$.tm_datepicker._curInst!==inst&&$.tm_datepicker._datepickerShowing&&$.tm_datepicker._lastInput!==input){return}
if(typeof inst.stay_open!=='boolean'||inst.stay_open===!1){this._base_updateDatepicker(inst);tp_inst=this._get(inst,'tm_timepicker');if(tp_inst){tp_inst._addTimePicker(inst)}}};$.tm_datepicker._base_doKeyPress=$.tm_datepicker._doKeyPress;$.tm_datepicker._doKeyPress=function(event){var inst=$.tm_datepicker._getInst(event.target),tp_inst=$.tm_datepicker._get(inst,'tm_timepicker');var ampm;var tz;var dateChars;var datetimeChars;var chr;if(tp_inst){if($.tm_datepicker._get(inst,'constrainInput')){ampm=tp_inst.support.ampm;tz=tp_inst._defaults.showTimezone!==null?tp_inst._defaults.showTimezone:tp_inst.support.timezone;dateChars=$.tm_datepicker._possibleChars($.tm_datepicker._get(inst,'dateFormat'));datetimeChars=tp_inst._defaults.timeFormat.toString().replace(/[hms]/g,'').replace(/TT/g,ampm?'APM':'').replace(/Tt/g,ampm?'AaPpMm':'').replace(/tT/g,ampm?'AaPpMm':'').replace(/T/g,ampm?'AP':'').replace(/tt/g,ampm?'apm':'').replace(/t/g,ampm?'ap':'')+' '+tp_inst._defaults.separator+tp_inst._defaults.timeSuffix+(tz?tp_inst._defaults.timezoneList.join(''):'')+tp_inst._defaults.amNames.join('')+tp_inst._defaults.pmNames.join('')+dateChars;chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);return event.ctrlKey||chr<' '||!dateChars||datetimeChars.indexOf(chr)>-1}}
return $.tm_datepicker._base_doKeyPress(event)};$.tm_datepicker._base_updateAlternate=$.tm_datepicker._updateAlternate;$.tm_datepicker._updateAlternate=function(inst){var tp_inst=this._get(inst,'tm_timepicker');var altField;var date;var formatCfg;var altFormattedDateTime;var altSeparator;var altTimeSuffix;var altTimeFormat;if(tp_inst){altField=tp_inst._defaults.altField;if(altField){date=this._getDate(inst);formatCfg=$.tm_datepicker._getFormatConfig(inst);altFormattedDateTime='';altSeparator=tp_inst._defaults.altSeparator?tp_inst._defaults.altSeparator:tp_inst._defaults.separator;altTimeSuffix=tp_inst._defaults.altTimeSuffix?tp_inst._defaults.altTimeSuffix:tp_inst._defaults.timeSuffix;altTimeFormat=tp_inst._defaults.altTimeFormat!==null?tp_inst._defaults.altTimeFormat:tp_inst._defaults.timeFormat;altFormattedDateTime+=$.tm_datepicker.formatTime(altTimeFormat,tp_inst,tp_inst._defaults)+altTimeSuffix;if(!tp_inst._defaults.timeOnly&&!tp_inst._defaults.altFieldTimeOnly&&date!==null){if(tp_inst._defaults.altFormat){altFormattedDateTime=$.tm_datepicker.formatDate(tp_inst._defaults.altFormat,date,formatCfg)+altSeparator+altFormattedDateTime}else{altFormattedDateTime=tp_inst.formattedDate+altSeparator+altFormattedDateTime}}
$(altField).val(inst.input.val()?altFormattedDateTime:'')}}else{$.tm_datepicker._base_updateAlternate(inst)}};$.tm_datepicker._base_doKeyUp=$.tm_datepicker._doKeyUp;$.tm_datepicker._doKeyUp=function(event){var inst=$.tm_datepicker._getInst(event.target),tp_inst=$.tm_datepicker._get(inst,'tm_timepicker');if(tp_inst){if(tp_inst._defaults.timeOnly&&inst.input.val()!==inst.lastVal){try{$.tm_datepicker._updateDatepicker(inst)}catch(err){$.tm_timepicker.log(err)}}}
return $.tm_datepicker._base_doKeyUp(event)};$.tm_datepicker._base_gotoToday=$.tm_datepicker._gotoToday;$.tm_datepicker._gotoToday=function(id){var inst=this._getInst($(id)[0]);var tp_inst;var tzoffset;var now;this._base_gotoToday(id);tp_inst=this._get(inst,'timepicker');if(!tp_inst){return}
tzoffset=$.tm_timepicker.timezoneOffsetNumber(tp_inst.timezone);now=new Date();now.setMinutes(now.getMinutes()+now.getTimezoneOffset()+parseInt(tzoffset,10));this._setTime(inst,now);this._setDate(inst,now);tp_inst._onSelectHandler()};$.tm_datepicker._disableTimepickerDatepicker=function(target){var inst=this._getInst(target);var tp_inst;if(!inst){return}
tp_inst=this._get(inst,'tm_timepicker');$(target).tm_datepicker('getDate');if(tp_inst){inst.settings.showTimepicker=!1;tp_inst._defaults.showTimepicker=!1;tp_inst._updateDateTime(inst)}};$.tm_datepicker._enableTimepickerDatepicker=function(target){var inst=this._getInst(target);var tp_inst;if(!inst){return}
tp_inst=this._get(inst,'tm_timepicker');$(target).tm_datepicker('getDate');if(tp_inst){inst.settings.showTimepicker=!0;tp_inst._defaults.showTimepicker=!0;tp_inst._addTimePicker(inst);tp_inst._updateDateTime(inst)}};$.tm_datepicker._setTime=function(inst,date){var tp_inst=this._get(inst,'tm_timepicker');var defaults;if(tp_inst){defaults=tp_inst._defaults;tp_inst.hour=date?date.getHours():defaults.hour;tp_inst.minute=date?date.getMinutes():defaults.minute;tp_inst.second=date?date.getSeconds():defaults.second;tp_inst.millisec=date?date.getMilliseconds():defaults.millisec;tp_inst.microsec=date?date.getMicroseconds():defaults.microsec;tp_inst._limitMinMaxDateTime(inst,!0);tp_inst._onTimeChange();tp_inst._updateDateTime(inst)}};$.tm_datepicker._setTimeDatepicker=function(target,date,withDate){var inst=this._getInst(target);var tp_inst;var tp_date;if(!inst){return}
tp_inst=this._get(inst,'tm_timepicker');if(tp_inst){this._setDateFromField(inst);if(date){if(typeof date==='string'){tp_inst._parseTime(date,withDate);tp_date=new Date();tp_date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec);tp_date.setMicroseconds(tp_inst.microsec)}else{tp_date=new Date(date.getTime());tp_date.setMicroseconds(date.getMicroseconds())}
if(tp_date.toString()==='Invalid Date'){tp_date=undefined}
this._setTime(inst,tp_date)}}};$.tm_datepicker._base_setDateDatepicker=$.tm_datepicker._setDateDatepicker;$.tm_datepicker._setDateDatepicker=function(target,_date){var inst=this._getInst(target);var date=_date;var tp_inst;var tp_date;if(!inst){return}
if(typeof _date==='string'){date=new Date(_date);if(!date.getTime()){this._base_setDateDatepicker.apply(this,arguments);date=$(target).tm_datepicker('getDate')}}
tp_inst=this._get(inst,'tm_timepicker');if(date instanceof Date){tp_date=new Date(date.getTime());tp_date.setMicroseconds(date.getMicroseconds())}else{tp_date=date}
if(tp_inst&&tp_date){if(!tp_inst.support.timezone&&tp_inst._defaults.timezone===null){tp_inst.timezone=tp_date.getTimezoneOffset()*-1}
date=$.tm_timepicker.timezoneAdjust(date,$.tm_timepicker.timezoneOffsetString(-date.getTimezoneOffset()),tp_inst.timezone);tp_date=$.tm_timepicker.timezoneAdjust(tp_date,$.tm_timepicker.timezoneOffsetString(-tp_date.getTimezoneOffset()),tp_inst.timezone)}
this._updateDatepicker(inst);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(target,tp_date,!0)};$.tm_datepicker._base_getDateDatepicker=$.tm_datepicker._getDateDatepicker;$.tm_datepicker._getDateDatepicker=function(target,noDefault){var inst=this._getInst(target);var tp_inst;var date;var currDT;if(!inst){return}
tp_inst=this._get(inst,'tm_timepicker');if(tp_inst){if(inst.lastVal===undefined){this._setDateFromField(inst,noDefault)}
date=this._getDate(inst);currDT=null;if(tp_inst.$altInput&&tp_inst._defaults.altFieldTimeOnly){currDT=tp_inst.$input.val()+' '+tp_inst.$altInput.val()}else if(tp_inst.$input.get(0).tagName!=='INPUT'&&tp_inst.$altInput){currDT=tp_inst.$altInput.val()}else{currDT=tp_inst.$input.val()}
if(date&&tp_inst._parseTime(currDT,!inst.settings.timeOnly)){date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec);date.setMicroseconds(tp_inst.microsec);if(tp_inst.timezone!==null){if(!tp_inst.support.timezone&&tp_inst._defaults.timezone===null){tp_inst.timezone=date.getTimezoneOffset()*-1}
date=$.tm_timepicker.timezoneAdjust(date,tp_inst.timezone,$.tm_timepicker.timezoneOffsetString(-date.getTimezoneOffset()))}}
return date}
return this._base_getDateDatepicker(target,noDefault)};$.tm_datepicker._base_parseDate=$.tm_datepicker.parseDate;$.tm_datepicker.parseDate=function(format,value,settings){var date;try{date=this._base_parseDate(format,value,settings)}catch(err){if(err.indexOf(':')>=0){date=this._base_parseDate(format,value.substring(0,value.length-(err.length-err.indexOf(':')-2)),settings);$.tm_timepicker.log('Error parsing the date string: '+err+'\ndate string = '+value+'\ndate format = '+format)}else{throw err}}
return date};$.tm_datepicker._base_formatDate=$.tm_datepicker._formatDate;$.tm_datepicker._formatDate=function(inst){var tp_inst=this._get(inst,'tm_timepicker');if(tp_inst){tp_inst._updateDateTime(inst);return tp_inst.$input.val()}
return this._base_formatDate(inst)};$.tm_datepicker._base_optionDatepicker=$.tm_datepicker._optionDatepicker;$.tm_datepicker._optionDatepicker=function(target,name,value){var inst=this._getInst(target),name_clone;var tp_inst;var min,max,onselect,overrides,fns,prop,ret,oldVal,$target;if(!inst){return null}
tp_inst=this._get(inst,'tm_timepicker');if(tp_inst){min=null;max=null;onselect=null;overrides=tp_inst._defaults.evnts;fns={};if(typeof name==='string'){if(name==='minDate'||name==='minDateTime'){min=value}else if(name==='maxDate'||name==='maxDateTime'){max=value}else if(name==='onSelect'){onselect=value}else if(Object.prototype.hasOwnProperty.call(overrides,name)){if(typeof value==='undefined'){return overrides[name]}
fns[name]=value;name_clone={}}}else if(typeof name==='object'){if(name.minDate){min=name.minDate}else if(name.minDateTime){min=name.minDateTime}else if(name.maxDate){max=name.maxDate}else if(name.maxDateTime){max=name.maxDateTime}
for(prop in overrides){if(Object.prototype.hasOwnProperty.call(overrides,prop)&&name[prop]){fns[prop]=name[prop]}}}
for(prop in fns){if(Object.prototype.hasOwnProperty.call(fns,prop)){overrides[prop]=fns[prop];if(!name_clone){name_clone=$.extend({},name)}
delete name_clone[prop]}}
if(name_clone&&isEmptyObject(name_clone)){return}
if(min){if(min===0){min=new Date()}else{min=new Date(min)}
tp_inst._defaults.minDate=min;tp_inst._defaults.minDateTime=min}else if(max){if(max===0){max=new Date()}else{max=new Date(max)}
tp_inst._defaults.maxDate=max;tp_inst._defaults.maxDateTime=max}else if(onselect){tp_inst._defaults.onSelect=onselect}
if(min||max){$target=$(target);oldVal=$target.tm_datetimepicker('getDate');ret=this._base_optionDatepicker.call($.tm_datepicker,target,name_clone||name,value);$target.tm_datetimepicker('setDate',oldVal);return ret}}
if(value===undefined){return this._base_optionDatepicker.call($.tm_datepicker,target,name)}
return this._base_optionDatepicker.call($.tm_datepicker,target,name_clone||name,value)};$.tm_timepicker=new Timepicker();$.tm_timepicker.timezoneOffsetString=function(tzMinutes,iso8601){var off,minutes,hours,iso,tz;if(isNaN(tzMinutes)||tzMinutes>840||tzMinutes<-720){return tzMinutes}
off=tzMinutes;minutes=off%60;hours=(off-minutes)/60;iso=iso8601?':':'';tz=(off>=0?'+':'-')+('0'+Math.abs(hours)).slice(-2)+iso+('0'+Math.abs(minutes)).slice(-2);if(tz==='+00:00'){return'Z'}
return tz};$.tm_timepicker.timezoneOffsetNumber=function(tzString){var normalized=tzString.toString().replace(':','');if(normalized.toUpperCase()==='Z'){return 0}
if(!/^(-|\+)\d{4}$/.test(normalized)){return parseInt(tzString,10)}
return((normalized.substring(0,1)==='-'?-1:1)*((parseInt(normalized.substring(1,3),10)*60)+parseInt(normalized.substring(3,5),10)))};$.tm_timepicker.timezoneAdjust=function(date,fromTimezone,toTimezone){var fromTz=$.timepicker.timezoneOffsetNumber(fromTimezone);var toTz=$.tm_timepicker.timezoneOffsetNumber(toTimezone);if(!isNaN(toTz)){date.setMinutes(date.getMinutes()+ -fromTz- -toTz)}
return date};$.tm_timepicker.timeRange=function(startTime,endTime,options){return $.tm_timepicker.handleRange('tm_timepicker',startTime,endTime,options)};$.tm_timepicker.datetimeRange=function(startTime,endTime,options){$.tm_timepicker.handleRange('tm_datetimepicker',startTime,endTime,options)};$.tm_timepicker.dateRange=function(startTime,endTime,options){$.tm_timepicker.handleRange('tm_datepicker',startTime,endTime,options)};$.tm_timepicker.handleRange=function(method,startTime,endTime,options){var timeOnly=!1;options=$.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},options);if(method==='tm_timepicker'){timeOnly=!0;method='tm_datetimepicker'}
function checkDates(changed,other){var startdt=startTime[method]('getDate'),enddt=endTime[method]('getDate'),changeddt=changed[method]('getDate');var minDate;var maxDate;if(startdt!==null){minDate=new Date(startdt.getTime());maxDate=new Date(startdt.getTime());minDate.setMilliseconds(minDate.getMilliseconds()+options.minInterval);maxDate.setMilliseconds(maxDate.getMilliseconds()+options.maxInterval);if(options.minInterval>0&&minDate>enddt){endTime[method]('setDate',minDate)}else if(options.maxInterval>0&&maxDate<enddt){endTime[method]('setDate',maxDate)}else if(startdt>enddt){other[method]('setDate',changeddt)}}}
function selected(changed,other,option){var date;if(!changed.val()){return}
date=changed[method].call(changed,'getDate');if(date!==null&&options.minInterval>0){if(option==='minDate'){date.setMilliseconds(date.getMilliseconds()+options.minInterval)}
if(option==='maxDate'){date.setMilliseconds(date.getMilliseconds()-options.minInterval)}}
if(date.getTime){other[method].call(other,'option',option,date)}}
$.fn[method].call(startTime,$.extend({timeOnly:timeOnly,onClose:function(){checkDates($(this),endTime)},onSelect:function(){selected($(this),endTime,'minDate')}},options,options.start));$.fn[method].call(endTime,$.extend({timeOnly:timeOnly,onClose:function(){checkDates($(this),startTime)},onSelect:function(){selected($(this),startTime,'maxDate')}},options,options.end));checkDates(startTime,endTime);selected(startTime,endTime,'minDate');selected(endTime,startTime,'maxDate');return $([startTime.get(0),endTime.get(0)])};$.tm_timepicker.log=function(){if(window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,Array.prototype.slice.call(arguments))}};$.tm_timepicker._util={_extendRemove:extendRemove,_isEmptyObject:isEmptyObject,_convert24to12:convert24to12,_detectSupport:detectSupport,_selectLocalTimezone:selectLocalTimezone,_computeEffectiveSetting:computeEffectiveSetting,_splitDateTime:splitDateTime,_parseDateTimeInternal:parseDateTimeInternal};if(!Date.prototype.getMicroseconds){Object.defineProperty(Date.prototype,'microseconds',{value:0,writable:!0});Object.defineProperty(Date.prototype,'getMicroseconds',{value:function(){return this.microseconds}});Object.defineProperty(Date.prototype,'setMicroseconds',{value:function(m){this.setMilliseconds(this.getMilliseconds()+Math.floor(m/1000));this.microseconds=m%1000;return this}})}
$.tm_timepicker.version='1.6.3'}))